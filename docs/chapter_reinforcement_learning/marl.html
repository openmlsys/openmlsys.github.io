<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
  <meta content="ie=edge" http-equiv="x-ua-compatible"/>
  <title>
   15.4. 多智能体强化学习 — 机器学习系统：设计和实现 1.0.0 documentation
  </title>
  <link href="../_static/material-design-lite-1.3.0/material.blue-deep_orange.min.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/sphinx_materialdesign_theme.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/fontawesome/all.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/fonts.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/basic.css" rel="stylesheet" type="text/css"/>
  <link href="../_static/d2l.css" rel="stylesheet" type="text/css"/>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js">
  </script>
  <script src="../_static/jquery.js">
  </script>
  <script src="../_static/underscore.js">
  </script>
  <script src="../_static/_sphinx_javascript_frameworks_compat.js">
  </script>
  <script src="../_static/doctools.js">
  </script>
  <script src="../_static/sphinx_highlight.js">
  </script>
  <script src="../_static/d2l.js">
  </script>
  <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <link href="../_static/favicon.png" rel="shortcut icon"/>
  <link href="../genindex.html" rel="index" title="Index"/>
  <link href="../search.html" rel="search" title="Search"/>
  <link href="marl_sys.html" rel="next" title="15.5. 多智能体强化学习系统"/>
  <link href="distributed_node_rl.html" rel="prev" title="15.3. 分布式强化学习系统"/>
 </head>
 <body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer">
   <header class="mdl-layout__header mdl-layout__header--waterfall">
    <div class="mdl-layout__header-row">
     <nav class="mdl-navigation breadcrumb">
      <a class="mdl-navigation__link" href="index.html">
       <span class="section-number">
        15.
       </span>
       强化学习系统
      </a>
      <i class="material-icons">
       navigate_next
      </i>
      <a class="mdl-navigation__link is-active">
       <span class="section-number">
        15.4.
       </span>
       多智能体强化学习
      </a>
     </nav>
     <div class="mdl-layout-spacer">
     </div>
     <nav class="mdl-navigation">
      <form action="../search.html" class="form-inline pull-sm-right" method="get">
       <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label class="mdl-button mdl-js-button mdl-button--icon" for="waterfall-exp" id="quick-search-icon">
         <i class="material-icons">
          search
         </i>
        </label>
        <div class="mdl-textfield__expandable-holder">
         <input class="mdl-textfield__input" id="waterfall-exp" name="q" placeholder="Search" type="text"/>
         <input name="check_keywords" type="hidden" value="yes"/>
         <input name="area" type="hidden" value="default"/>
        </div>
       </div>
       <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
        Quick search
       </div>
      </form>
      <a class="mdl-button mdl-js-button mdl-button--icon" href="../_sources/chapter_reinforcement_learning/marl.rst.txt" id="button-show-source" rel="nofollow">
       <i class="material-icons">
        code
       </i>
      </a>
      <div class="mdl-tooltip" data-mdl-for="button-show-source">
       Show Source
      </div>
     </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
     <div class="mdl-layout-spacer">
     </div>
     <nav class="mdl-navigation">
      <a class="mdl-navigation__link" href="https://github.com/openmlsys/openmlsys-zh">
       <i class="fab fa-github">
       </i>
       GitHub
      </a>
     </nav>
    </div>
   </header>
   <header class="mdl-layout__drawer">
    <!-- Title -->
    <span class="mdl-layout-title">
     <a class="title" href="../index.html">
      <img alt="机器学习系统：设计和实现" class="logo" src="../_static/logo-with-text.png"/>
     </a>
    </span>
    <div class="globaltoc">
     <span class="mdl-layout-title toc">
      Table Of Contents
     </span>
     <nav class="mdl-navigation">
      <ul class="current">
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_preface/index.html">
         1. 前言
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_introduction/index.html">
         2. 导论
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_introduction/applications.html">
           2.1. 机器学习应用
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_introduction/design.html">
           2.2. 机器学习框架的设计目标
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_introduction/architecture.html">
           2.3. 机器学习框架的基本组成原理
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_introduction/ecosystem.html">
           2.4. 机器学习系统生态
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_introduction/readers.html">
           2.5. 图书结构和读者
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_programming_interface/index.html">
         3. 编程接口
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/development_history.html">
           3.1. 机器学习系统编程模型的演进
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/ml_workflow.html">
           3.2. 机器学习工作流
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/neural_network_layer.html">
           3.3. 定义深度神经网络
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/c_python_interaction.html">
           3.4. C/C++编程接口
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/ml_programming_paradigm.html">
           3.5. 机器学习框架的编程范式
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/summary.html">
           3.6. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_programming_interface/summary.html#id2">
           3.7. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_computational_graph/index.html">
         4. 计算图
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/background_and_functionality.html">
           4.1. 计算图的设计背景和作用
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/components_of_computational_graph.html">
           4.2. 计算图的基本构成
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/generation_of_computational_graph.html">
           4.3. 计算图的生成
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/schedule_of_computational_graph.html">
           4.4. 计算图的调度
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/summary.html">
           4.5. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_computational_graph/summary.html#id2">
           4.6. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_preface_advanced/index.html">
         5. 第二部分：进阶篇
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_frontend_and_ir/index.html">
         6. AI编译器和前端技术
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/ai_compiler_design_principle.html">
           6.1. AI编译器设计原理
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/overview_of_frontend.html">
           6.2. AI编译器前端技术概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/intermediate_representation.html">
           6.3. 中间表示
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/ad.html">
           6.4. 自动微分
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/type_system_and_static_analysis.html">
           6.5. 类型系统和静态分析
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/common_frontend_optimization_pass.html">
           6.6. 常见前端编译优化方法
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/summary.html">
           6.7. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_frontend_and_ir/summary.html#id2">
           6.8. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_backend_and_runtime/index.html">
         7. 编译器后端和运行时
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/overview.html">
           7.1. 概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/graph_optimizer.html">
           7.2. 计算图优化
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/kernel_selecter.html">
           7.3. 算子选择
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/memory_allocator.html">
           7.4. 内存分配
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/compute_schedule_and_execute.html">
           7.5. 计算调度与执行
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/op_compiler.html">
           7.6. 算子编译器
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/summary.html">
           7.7. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_backend_and_runtime/summary.html#id2">
           7.8. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_accelerator/index.html">
         8. 硬件加速器
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/accelerator_introduction.html">
           8.1. 概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/accelerator_architecture.html">
           8.2. 加速器基本组成原理
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/accelerator_programming.html">
           8.3. 加速器基本编程原理
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/accelerator_practise.html">
           8.4. 加速器实践
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/summary.html">
           8.5. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/summary.html#id2">
           8.6. 扩展阅读
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_accelerator/summary.html#id3">
           8.7. 参考文献
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_data_processing/index.html">
         9. 数据处理框架
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/requirements.html">
           9.1. 概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/program_model.html">
           9.2. 易用性设计
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/performance.html">
           9.3. 高效性设计
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/data_order.html">
           9.4. 保序性设计
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/extension.html">
           9.5. 单机数据处理性能的扩展
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/summary.html">
           9.6. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_data_processing/summary.html#id2">
           9.7. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_model_deployment/index.html">
         10. 模型部署
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/model_deployment_introduction.html">
           10.1. 概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/model_converter_and_optimizer.html">
           10.2. 训练模型到推理模型的转换及优化
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/model_compression.html">
           10.3. 模型压缩
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/model_inference.html">
           10.4. 模型推理
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/model_security.html">
           10.5. 模型的安全保护
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/summary.html">
           10.6. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_model_deployment/summary.html#id2">
           10.7. 扩展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_distributed_training/index.html">
         11. 分布式训练
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/overview.html">
           11.1. 系统概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/methods.html">
           11.2. 实现方法
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/methods.html#id6">
           11.3. 流水线并行
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/cluster.html">
           11.4. 机器学习集群架构
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/collective.html">
           11.5. 集合通信
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/parameter_servers.html">
           11.6. 参数服务器
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/summary.html">
           11.7. 总结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_distributed_training/summary.html#id2">
           11.8. 拓展阅读
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_preface_extension/index.html">
         12. 第三部分：拓展篇
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_recommender_system/index.html">
         13. 深度学习推荐系统
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/system_architecture.html">
           13.1. 系统基本组成
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/multi_stage_recommender_system.html">
           13.2. 多阶段推荐系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/model_update.html">
           13.3. 模型更新
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/case_study.html">
           13.4. 案例分析：支持在线模型更新的大型推荐系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/summary.html">
           13.5. 小结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/summary.html#id2">
           13.6. 扩展阅读
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_recommender_system/summary.html#id3">
           13.7. 参考文献
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_federated_learning/index.html">
         14. 联邦学习系统
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/overview.html">
           14.1. 概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/horizontal_fl.html">
           14.2. 横向联邦学习
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/vertical_fl.html">
           14.3. 纵向联邦学习
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/privacy_encryption_algorithm.html">
           14.4. 隐私加密算法
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/outlook.html">
           14.5. 展望
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_federated_learning/summary.html">
           14.6. 小结
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1 current">
        <a class="reference internal" href="index.html">
         15. 强化学习系统
        </a>
        <ul class="current">
         <li class="toctree-l2">
          <a class="reference internal" href="rl_introduction.html">
           15.1. 强化学习介绍
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="single_node_rl.html">
           15.2. 单节点强化学习系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="distributed_node_rl.html">
           15.3. 分布式强化学习系统
          </a>
         </li>
         <li class="toctree-l2 current">
          <a class="current reference internal" href="#">
           15.4. 多智能体强化学习
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="marl_sys.html">
           15.5. 多智能体强化学习系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="summary.html">
           15.6. 小结
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="summary.html#id2">
           15.7. 参考文献
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_explainable_AI/index.html">
         16. 可解释性AI系统
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html">
           16.1. 背景
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#ai">
           16.2. 可解释AI定义
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id2">
           16.3. 可解释AI算法现状介绍
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id17">
           16.4. 可解释AI系统及实践
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id21">
           16.5. 未来可解释AI
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id22">
           16.6. 参考文献
          </a>
         </li>
        </ul>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../chapter_rl_sys/index.html">
         17. 机器人系统
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_rl_sys/rl_sys_intro.html">
           17.1. 机器人系统概述
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_rl_sys/ros.html">
           17.2. 通用机器人操作系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_rl_sys/ros_code_ex.html">
           17.3. 案例分析：使用机器人操作系统
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../chapter_rl_sys/summary.html">
           17.4. 总结
          </a>
         </li>
        </ul>
       </li>
      </ul>
      <ul>
       <li class="toctree-l1">
        <a class="reference internal" href="../appendix_machine_learning_introduction/index.html">
         附录：机器学习介绍
        </a>
        <ul>
         <li class="toctree-l2">
          <a class="reference internal" href="../appendix_machine_learning_introduction/neural_network.html">
           1. 神经网络
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../appendix_machine_learning_introduction/gradient_descent.html">
           2. 梯度下降与反向传播
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../appendix_machine_learning_introduction/classic_machine_learning.html">
           3. 经典机器学习方法
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="../appendix_machine_learning_introduction/classic_machine_learning.html#id4">
           4. 参考文献
          </a>
         </li>
        </ul>
       </li>
      </ul>
     </nav>
    </div>
   </header>
   <main class="mdl-layout__content" tabindex="0">
    <script src="../_static/sphinx_materialdesign_theme.js " type="text/javascript">
    </script>
    <header class="mdl-layout__drawer">
     <!-- Title -->
     <span class="mdl-layout-title">
      <a class="title" href="../index.html">
       <img alt="机器学习系统：设计和实现" class="logo" src="../_static/logo-with-text.png"/>
      </a>
     </span>
     <div class="globaltoc">
      <span class="mdl-layout-title toc">
       Table Of Contents
      </span>
      <nav class="mdl-navigation">
       <ul class="current">
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_preface/index.html">
          1. 前言
         </a>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_introduction/index.html">
          2. 导论
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_introduction/applications.html">
            2.1. 机器学习应用
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_introduction/design.html">
            2.2. 机器学习框架的设计目标
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_introduction/architecture.html">
            2.3. 机器学习框架的基本组成原理
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_introduction/ecosystem.html">
            2.4. 机器学习系统生态
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_introduction/readers.html">
            2.5. 图书结构和读者
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_programming_interface/index.html">
          3. 编程接口
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/development_history.html">
            3.1. 机器学习系统编程模型的演进
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/ml_workflow.html">
            3.2. 机器学习工作流
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/neural_network_layer.html">
            3.3. 定义深度神经网络
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/c_python_interaction.html">
            3.4. C/C++编程接口
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/ml_programming_paradigm.html">
            3.5. 机器学习框架的编程范式
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/summary.html">
            3.6. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_programming_interface/summary.html#id2">
            3.7. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_computational_graph/index.html">
          4. 计算图
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/background_and_functionality.html">
            4.1. 计算图的设计背景和作用
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/components_of_computational_graph.html">
            4.2. 计算图的基本构成
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/generation_of_computational_graph.html">
            4.3. 计算图的生成
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/schedule_of_computational_graph.html">
            4.4. 计算图的调度
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/summary.html">
            4.5. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_computational_graph/summary.html#id2">
            4.6. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_preface_advanced/index.html">
          5. 第二部分：进阶篇
         </a>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_frontend_and_ir/index.html">
          6. AI编译器和前端技术
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/ai_compiler_design_principle.html">
            6.1. AI编译器设计原理
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/overview_of_frontend.html">
            6.2. AI编译器前端技术概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/intermediate_representation.html">
            6.3. 中间表示
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/ad.html">
            6.4. 自动微分
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/type_system_and_static_analysis.html">
            6.5. 类型系统和静态分析
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/common_frontend_optimization_pass.html">
            6.6. 常见前端编译优化方法
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/summary.html">
            6.7. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_frontend_and_ir/summary.html#id2">
            6.8. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_backend_and_runtime/index.html">
          7. 编译器后端和运行时
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/overview.html">
            7.1. 概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/graph_optimizer.html">
            7.2. 计算图优化
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/kernel_selecter.html">
            7.3. 算子选择
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/memory_allocator.html">
            7.4. 内存分配
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/compute_schedule_and_execute.html">
            7.5. 计算调度与执行
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/op_compiler.html">
            7.6. 算子编译器
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/summary.html">
            7.7. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_backend_and_runtime/summary.html#id2">
            7.8. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_accelerator/index.html">
          8. 硬件加速器
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/accelerator_introduction.html">
            8.1. 概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/accelerator_architecture.html">
            8.2. 加速器基本组成原理
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/accelerator_programming.html">
            8.3. 加速器基本编程原理
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/accelerator_practise.html">
            8.4. 加速器实践
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/summary.html">
            8.5. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/summary.html#id2">
            8.6. 扩展阅读
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_accelerator/summary.html#id3">
            8.7. 参考文献
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_data_processing/index.html">
          9. 数据处理框架
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/requirements.html">
            9.1. 概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/program_model.html">
            9.2. 易用性设计
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/performance.html">
            9.3. 高效性设计
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/data_order.html">
            9.4. 保序性设计
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/extension.html">
            9.5. 单机数据处理性能的扩展
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/summary.html">
            9.6. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_data_processing/summary.html#id2">
            9.7. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_model_deployment/index.html">
          10. 模型部署
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/model_deployment_introduction.html">
            10.1. 概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/model_converter_and_optimizer.html">
            10.2. 训练模型到推理模型的转换及优化
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/model_compression.html">
            10.3. 模型压缩
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/model_inference.html">
            10.4. 模型推理
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/model_security.html">
            10.5. 模型的安全保护
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/summary.html">
            10.6. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_model_deployment/summary.html#id2">
            10.7. 扩展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_distributed_training/index.html">
          11. 分布式训练
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/overview.html">
            11.1. 系统概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/methods.html">
            11.2. 实现方法
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/methods.html#id6">
            11.3. 流水线并行
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/cluster.html">
            11.4. 机器学习集群架构
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/collective.html">
            11.5. 集合通信
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/parameter_servers.html">
            11.6. 参数服务器
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/summary.html">
            11.7. 总结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_distributed_training/summary.html#id2">
            11.8. 拓展阅读
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_preface_extension/index.html">
          12. 第三部分：拓展篇
         </a>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_recommender_system/index.html">
          13. 深度学习推荐系统
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/system_architecture.html">
            13.1. 系统基本组成
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/multi_stage_recommender_system.html">
            13.2. 多阶段推荐系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/model_update.html">
            13.3. 模型更新
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/case_study.html">
            13.4. 案例分析：支持在线模型更新的大型推荐系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/summary.html">
            13.5. 小结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/summary.html#id2">
            13.6. 扩展阅读
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_recommender_system/summary.html#id3">
            13.7. 参考文献
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_federated_learning/index.html">
          14. 联邦学习系统
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/overview.html">
            14.1. 概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/horizontal_fl.html">
            14.2. 横向联邦学习
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/vertical_fl.html">
            14.3. 纵向联邦学习
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/privacy_encryption_algorithm.html">
            14.4. 隐私加密算法
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/outlook.html">
            14.5. 展望
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_federated_learning/summary.html">
            14.6. 小结
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1 current">
         <a class="reference internal" href="index.html">
          15. 强化学习系统
         </a>
         <ul class="current">
          <li class="toctree-l2">
           <a class="reference internal" href="rl_introduction.html">
            15.1. 强化学习介绍
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="single_node_rl.html">
            15.2. 单节点强化学习系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="distributed_node_rl.html">
            15.3. 分布式强化学习系统
           </a>
          </li>
          <li class="toctree-l2 current">
           <a class="current reference internal" href="#">
            15.4. 多智能体强化学习
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="marl_sys.html">
            15.5. 多智能体强化学习系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="summary.html">
            15.6. 小结
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="summary.html#id2">
            15.7. 参考文献
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_explainable_AI/index.html">
          16. 可解释性AI系统
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html">
            16.1. 背景
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#ai">
            16.2. 可解释AI定义
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id2">
            16.3. 可解释AI算法现状介绍
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id17">
            16.4. 可解释AI系统及实践
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id21">
            16.5. 未来可解释AI
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_explainable_AI/explainable_ai.html#id22">
            16.6. 参考文献
           </a>
          </li>
         </ul>
        </li>
        <li class="toctree-l1">
         <a class="reference internal" href="../chapter_rl_sys/index.html">
          17. 机器人系统
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_rl_sys/rl_sys_intro.html">
            17.1. 机器人系统概述
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_rl_sys/ros.html">
            17.2. 通用机器人操作系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_rl_sys/ros_code_ex.html">
            17.3. 案例分析：使用机器人操作系统
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../chapter_rl_sys/summary.html">
            17.4. 总结
           </a>
          </li>
         </ul>
        </li>
       </ul>
       <ul>
        <li class="toctree-l1">
         <a class="reference internal" href="../appendix_machine_learning_introduction/index.html">
          附录：机器学习介绍
         </a>
         <ul>
          <li class="toctree-l2">
           <a class="reference internal" href="../appendix_machine_learning_introduction/neural_network.html">
            1. 神经网络
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../appendix_machine_learning_introduction/gradient_descent.html">
            2. 梯度下降与反向传播
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../appendix_machine_learning_introduction/classic_machine_learning.html">
            3. 经典机器学习方法
           </a>
          </li>
          <li class="toctree-l2">
           <a class="reference internal" href="../appendix_machine_learning_introduction/classic_machine_learning.html#id4">
            4. 参考文献
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </nav>
     </div>
    </header>
    <div class="document">
     <div class="page-content" role="main">
      <div class="section" id="ch12-ch12-marl">
       <span id="id1">
       </span>
       <h1>
        <span class="section-number">
         15.4.
        </span>
        多智能体强化学习
        <a class="headerlink" href="#ch12-ch12-marl" title="Permalink to this heading">
         ¶
        </a>
       </h1>
       <p>
        以上所讲述的强化学习内容都为单智能体强化学习，而在近来的强化学习研究中，多智能体强化学习越来越受到研究人员关注。回想在本小节初介绍的单智能体强化学习框架
        <a class="reference internal" href="rl_introduction.html#ch12-ch12-rl-framework">
         <span class="std std-numref">
          图15.1.1
         </span>
        </a>
        ，其中我们只有单个智能体产生的单个动作对环境产生影响，环境也返回单个奖励值给智能体。这里我们把单智能体强化学习扩展到多智能体强化学习，可以得到至少两种可能的多智能体强化学习框架，如
        <a class="reference internal" href="#ch12-ch12-marl">
         <span class="std std-numref">
          15.4节
         </span>
        </a>
        所示。
        <a class="reference internal" href="#ch12-ch12-marl">
         <span class="std std-numref">
          15.4节
         </span>
        </a>
        (a)为多智能体同时执行动作的情况，他们相互之间观察不到彼此的动作，他们的动作一同对环境产生影响，并各自接受自己动作所产生的奖励。
        <a class="reference internal" href="#ch12-ch12-marl">
         <span class="std std-numref">
          15.4节
         </span>
        </a>
        (b)为多智能体顺序执行动作的情况，后续智能体可能观察到前序智能体的动作，他们的动作一同对环境产生影响，并接受到各自的奖励值或共同的奖励值。除此之外，还有许多其他可能的多智能体框架，如更复杂的智能体间观察机制、智能体间通讯机制、多智能体合作与竞争等等。同时，这里假设多个智能体对环境的观察量都为环境的状态，这是最简单的一种，也是现实中最不可能出现的一种，实际情况下的多智能体往往对环境有各自不同的观察量。
        <img alt="两种可能的多智能体强化学习框架：（a）同步式多智能体决策；（b）异步式多智能体决策。" src="../_images/ch12-marl.png"/>
       </p>
       <blockquote>
        <div>
         <dl class="field-list simple">
          <dt class="field-odd">
           width
          </dt>
          <dd class="field-odd">
           <p>
            800px
           </p>
          </dd>
         </dl>
        </div>
       </blockquote>
       <p>
        这里我们可以根据前面对单智能体强化学习过程的马尔可夫决策过程描述，给出多智能体强化学习的马尔可夫决策过程，它可以用一个数组
        <span class="math notranslate nohighlight">
         \((\mathcal{S}, N, \boldsymbol{\mathcal{A}}, \mathbf{R}, \mathcal{T}, \gamma)\)
        </span>
        来表示。
        <span class="math notranslate nohighlight">
         \(N\)
        </span>
        是智能体个数，
        <span class="math notranslate nohighlight">
         \(\mathcal{S}\)
        </span>
        和
        <span class="math notranslate nohighlight">
         \(\boldsymbol{\mathcal{A}}=(\mathcal{A}_1, \mathcal{A}_2, ..., \mathcal{A}_N)\)
        </span>
        分别是环境状态空间和多智能体动作空间，其中
        <span class="math notranslate nohighlight">
         \(A_i\)
        </span>
        是第
        <span class="math notranslate nohighlight">
         \(i\)
        </span>
        个智能体的动作空间，
        <span class="math notranslate nohighlight">
         \(\mathbf{R}=(R_1, R_2, ..., R_N)\)
        </span>
        是多智能体奖励函数，
        <span class="math notranslate nohighlight">
         \(\mathbf{R}(s,\mathbf{a})\)
        </span>
        :
        <span class="math notranslate nohighlight">
         \(\mathcal{S}\times \boldsymbol{\mathcal{A}}\rightarrow \mathbb{R}^N\)
        </span>
        为对于当前状态
        <span class="math notranslate nohighlight">
         \(s\in\mathcal{S}\)
        </span>
        和当前多智能体动作
        <span class="math notranslate nohighlight">
         \(\mathbf{a}\in\boldsymbol{\mathcal{A}}\)
        </span>
        的奖励向量值，其中
        <span class="math notranslate nohighlight">
         \(R_i\)
        </span>
        是对第
        <span class="math notranslate nohighlight">
         \(i\)
        </span>
        个智能体的奖励值。从当前状态和动作到下一个状态的状态转移概率定义为
        <span class="math notranslate nohighlight">
         \(\mathcal{T}(s^\prime|s,\mathbf{a})\)
        </span>
        :
        <span class="math notranslate nohighlight">
         \(\mathcal{S}\times\boldsymbol{\mathcal{A}}\times\mathcal{S}\rightarrow \mathbb{R}_+\)
        </span>
        。
        <span class="math notranslate nohighlight">
         \(\gamma\in(0,1)\)
        </span>
        是奖励折扣因子（假设多个智能体采用相同的奖励折扣因子）。不同于单智能体强化学习，多智能体强化学习的目标除了常见的最大化每个智能体各自的期望累计奖励值
        <span class="math notranslate nohighlight">
         \(\mathbb{E}[\sum_t \gamma^t r^i_t], i\in[N]\)
        </span>
        之外，还有许多其他可能的学习目标，如达到纳什均衡、最大化团队奖励等等。
       </p>
       <p>
        由上述介绍和定义可以发现，多智能体强化学习是一个比单智能体强化学习更加复杂的问题。而实际上，多个智能体的存在，对于每个智能体的决策而言，绝对不是简单的把每个单智能体决策累加的难度，实际情况要比单智能体决策问题复杂很多。多智能体系统的研究实际上是门古老的学科，它与博弈论（Game
Theory）密切相关，在深度强化学习盛行以前早已有大量研究和许多理论上未解的难题。其中一个典型的问题是纳什均衡在双人非零和博弈下没有多项式时间内可解的方法（实际上，这是一个PPAD（Polynomial
Parity Argument, Directed version）类的问题。（见论文Settling the
Complexity of Computing Two-Player Nash Equilibria. Xi Chen, et
al.）由于篇幅限制，我们这里无法对多智能体问题做深入探讨，我们可以用一个简单例子来介绍为什么多智能体强化学习问题无法简单地用单智能体强化学习算法来解。
       </p>
       <table class="docutils align-default" id="id2" style="margin-left:auto;margin-right:auto;margin-top:10px;margin-bottom:20px;">
        <caption>
         <span class="caption-number">
          表15.4.1
         </span>
         <span class="caption-text">
          剪刀-石头-布的奖励值表
         </span>
         <a class="headerlink" href="#id2" title="Permalink to this table">
          ¶
         </a>
        </caption>
        <colgroup>
         <col style="width: 58%"/>
         <col style="width: 14%"/>
         <col style="width: 14%"/>
         <col style="width: 14%"/>
        </colgroup>
        <thead>
         <tr class="row-odd">
          <th class="head">
           <p>
            奖励值
           </p>
          </th>
          <th class="head">
           <p>
            剪刀
           </p>
          </th>
          <th class="head">
           <p>
            石头
           </p>
          </th>
          <th class="head">
           <p>
            布
           </p>
          </th>
         </tr>
        </thead>
        <tbody>
         <tr class="row-even">
          <td>
           <p>
            <strong>
             剪刀
            </strong>
           </p>
          </td>
          <td>
           <p>
            (0,0)
           </p>
          </td>
          <td>
           <p>
            (-1,+1)
           </p>
          </td>
          <td>
           <p>
            (+1,-1)
           </p>
          </td>
         </tr>
         <tr class="row-odd">
          <td>
           <p>
            <strong>
             石头
            </strong>
           </p>
          </td>
          <td>
           <p>
            (+1,-1)
           </p>
          </td>
          <td>
           <p>
            (0,0)
           </p>
          </td>
          <td>
           <p>
            (-1,+1)
           </p>
          </td>
         </tr>
         <tr class="row-even">
          <td>
           <p>
            <strong>
             布
            </strong>
           </p>
          </td>
          <td>
           <p>
            (-1,+1)
           </p>
          </td>
          <td>
           <p>
            (+1,-1)
           </p>
          </td>
          <td>
           <p>
            (0,0)
           </p>
          </td>
         </tr>
         <tr class="row-odd">
          <td>
          </td>
          <td id="tab-ch12-ch12-marl">
          </td>
          <td>
          </td>
          <td>
          </td>
         </tr>
        </tbody>
       </table>
       <p>
        我们考虑一个大家都熟悉的游戏，
剪刀-石头-布，考虑两个玩家玩这个游戏的输赢情况，我们知道有这样的输赢关系：剪刀&lt;石头&lt;布&lt;剪刀…这里的“&lt;”即前一个纯策略被后一个纯策略完全压制，我们给予奖励值-1、+1到这两个玩家，当他们选择相同的纯策略时，奖励值均为0。于是我们得到一个奖励值表如
        <code class="xref std std-numref docutils literal notranslate">
         <span class="pre">
          tab_ch12_ch12_marl
         </span>
        </code>
        所示，横轴为玩家1，纵轴为玩家2，表内的数组为玩家1和玩家2各自在相应动作下得到的奖励值。
       </p>
       <p>
        由于这个矩阵的反对称性，这个问题的纳什均衡策略对两个玩家相同，均为
        <span class="math notranslate nohighlight">
         \((\frac{1}{3}, \frac{1}{3}, \frac{1}{3})\)
        </span>
        的策略分布，即有各
        <span class="math notranslate nohighlight">
         \(\frac{1}{3}\)
        </span>
        的概率出剪刀、石头或布。如果我们把得到这个纳什均衡策略作为多智能体学习的目标，那么我们可以简单分析得到这个均衡策略无法通过简单的单智能体算法得到。考虑我们随机初始化两个玩家为任意两个纯策略，比如玩家1出剪刀，玩家2出石头。这时假设玩家2策略固定，可以把玩家2看做固定环境的一部分，于是可以使用任意单智能体强化学习算法对玩家1进行训练，使其最大化自己的奖励值。于是，玩家1会收敛到布的纯策略。这时再把玩家1固定，训练玩家2，玩家2又收敛到剪刀的纯策略。于是循环往复，整个训练过程始终无法收敛，玩家1和2各自在3个策略中循环却无法得到正确的纳什均衡策略。
       </p>
       <div class="figure align-default" id="id3">
        <span id="ch12-ch12-marl-sp">
        </span>
        <a class="reference internal image-reference" href="../_images/ch12-marl-sp.png">
         <img alt="../_images/ch12-marl-sp.png" src="../_images/ch12-marl-sp.png" style="width: 600px;"/>
        </a>
        <p class="caption">
         <span class="caption-number">
          图15.4.1
         </span>
         <span class="caption-text">
          自学习算法示意图。
         </span>
         <a class="headerlink" href="#id3" title="Permalink to this image">
          ¶
         </a>
        </p>
       </div>
       <p>
        我们在上面这个例子中采用的学习方法其实是多智能体强化学习中最基础的一种，叫自学习（Selfplay），如
        <a class="reference internal" href="#ch12-ch12-marl-sp">
         <span class="std std-numref">
          图15.4.1
         </span>
        </a>
        所示。自学习的方法即固定当前玩家 1
的策略，按照单智能体优化的方法最大化一侧智能体的表现，所得策略称为最佳反应策略（Best
Response Strategy）。之后再将这一最佳反应策略作为玩家 2
的固定策略，再来优化另一边的智能体策略，如此循环。我们可以看到自学习在特定的任务设置下可能无法收敛到我们想要的最终目标。正是由于多智能体学习过程中有类似循环结构的出现，我们需要更复杂的训练方法，和专门针对多智能体的学习方式来达到我们想要的目标。
       </p>
       <p>
        一般来讲，多智能体强化学习是比单智能体强化学习更复杂的一类，对于自学习的方法而言，单智能体强化学习的过程可以看做一个多智能体强化学习的子任务。从前面这一小游戏的角度来理解，当玩家
1 策略固定时，玩家 1 加游戏环境构成玩家 2
的实际学习环境，由于这个环境是固定的，玩家 2
可以通过单智能体强化学习来达到自身奖励值最大化；这时再固定玩家 2
的策略，玩家 1 又可以进行单智能体强化学习……
这样，单智能体强化学习是多智能体任务的子任务。如
        <a class="reference internal" href="#ch12-ch12-marl-fsp">
         <span class="std std-numref">
          图15.4.2
         </span>
        </a>
        ，其他算法如虚构自学习（Fictitious
Self-play），需要在每个单智能体强化学习的步骤中，对对手历史策略的平均策略求得最优应对策略，而对手的训练也是如此，进行循环，能够在上面剪刀-石头-布一类的游戏中保证收敛到纳什均衡策略。
       </p>
       <div class="figure align-default" id="id4">
        <span id="ch12-ch12-marl-fsp">
        </span>
        <a class="reference internal image-reference" href="../_images/ch12-marl-fsp.png">
         <img alt="../_images/ch12-marl-fsp.png" src="../_images/ch12-marl-fsp.png" style="width: 600px;"/>
        </a>
        <p class="caption">
         <span class="caption-number">
          图15.4.2
         </span>
         <span class="caption-text">
          虚构自学习算法示意图。
         </span>
         <a class="headerlink" href="#id4" title="Permalink to this image">
          ¶
         </a>
        </p>
       </div>
      </div>
     </div>
     <div class="side-doc-outline">
      <div class="side-doc-outline--content">
      </div>
     </div>
     <div class="clearer">
     </div>
    </div>
    <div class="pagenation">
     <a accesskey="P" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" href="distributed_node_rl.html" id="button-prev" role="botton">
      <i class="pagenation-arrow-L fas fa-arrow-left fa-lg">
      </i>
      <div class="pagenation-text">
       <span class="pagenation-direction">
        Previous
       </span>
       <div>
        15.3. 分布式强化学习系统
       </div>
      </div>
     </a>
     <a accesskey="N" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" href="marl_sys.html" id="button-next" role="botton">
      <i class="pagenation-arrow-R fas fa-arrow-right fa-lg">
      </i>
      <div class="pagenation-text">
       <span class="pagenation-direction">
        Next
       </span>
       <div>
        15.5. 多智能体强化学习系统
       </div>
      </div>
     </a>
    </div>
   </main>
  </div>
 </body>
</html>